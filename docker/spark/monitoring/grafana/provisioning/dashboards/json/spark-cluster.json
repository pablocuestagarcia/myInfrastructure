{
  "annotations": { "list": [] },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "links": [],
  "panels": [
    {
      "title": "Workers Alive",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 0 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [{ "expr": "metrics_master_aliveWorkers_Value", "legendFormat": "workers" }],
      "fieldConfig": { "defaults": { "thresholds": { "steps": [{ "color": "red", "value": null }, { "color": "green", "value": 2 }] } }, "overrides": [] }
    },
    {
      "title": "Active Apps",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 0 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [{ "expr": "metrics_master_apps_Value", "legendFormat": "apps" }],
      "fieldConfig": { "defaults": { "thresholds": { "steps": [{ "color": "blue", "value": null }] } }, "overrides": [] }
    },
    {
      "title": "HTTP Requests by Worker",
      "type": "bargauge",
      "gridPos": { "h": 4, "w": 8, "x": 8, "y": 0 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [{ "expr": "spark_http_requests_total{status=\"success\"}", "legendFormat": "{{worker}}" }],
      "fieldConfig": { "defaults": { "thresholds": { "steps": [{ "color": "green", "value": null }] } }, "overrides": [] },
      "options": { "orientation": "horizontal", "displayMode": "gradient" }
    },
    {
      "title": "P95 HTTP Latency by Worker",
      "type": "stat",
      "gridPos": { "h": 4, "w": 8, "x": 16, "y": 0 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [{ "expr": "histogram_quantile(0.95, spark_http_request_duration_seconds_bucket)", "legendFormat": "{{worker}}" }],
      "fieldConfig": { "defaults": { "unit": "s", "thresholds": { "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.5 }, { "color": "red", "value": 1 }] } }, "overrides": [] }
    },
    {
      "title": "CPU Usage",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 4 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [{ "expr": "rate(container_cpu_usage_seconds_total{name=~\"spark-.*\"}[1m])", "legendFormat": "{{name}}" }],
      "fieldConfig": { "defaults": { "unit": "percentunit", "custom": { "fillOpacity": 15, "lineWidth": 2 } }, "overrides": [] }
    },
    {
      "title": "Memory Usage",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 4 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [{ "expr": "container_memory_usage_bytes{name=~\"spark-.*\"}", "legendFormat": "{{name}}" }],
      "fieldConfig": { "defaults": { "unit": "bytes", "custom": { "fillOpacity": 15, "lineWidth": 2 } }, "overrides": [] }
    },
    {
      "title": "Network TX (bytes/s)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 12 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [{ "expr": "rate(container_network_transmit_bytes_total{name=~\"spark-.*\", interface=\"eth0\"}[1m])", "legendFormat": "{{name}}" }],
      "fieldConfig": { "defaults": { "unit": "Bps", "custom": { "fillOpacity": 15, "lineWidth": 2 } }, "overrides": [] }
    },
    {
      "title": "Network RX (bytes/s)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 12 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [{ "expr": "rate(container_network_receive_bytes_total{name=~\"spark-.*\", interface=\"eth0\"}[1m])", "legendFormat": "{{name}}" }],
      "fieldConfig": { "defaults": { "unit": "Bps", "custom": { "fillOpacity": 15, "lineWidth": 2 } }, "overrides": [] }
    },
    {
      "title": "Disk Read (bytes/s)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 20 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [{ "expr": "rate(container_fs_reads_bytes_total{name=~\"spark-.*\"}[1m])", "legendFormat": "{{name}}" }],
      "fieldConfig": { "defaults": { "unit": "Bps", "custom": { "fillOpacity": 15, "lineWidth": 2 } }, "overrides": [] }
    },
    {
      "title": "Disk Write (bytes/s)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 20 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [{ "expr": "rate(container_fs_writes_bytes_total{name=~\"spark-.*\"}[1m])", "legendFormat": "{{name}}" }],
      "fieldConfig": { "defaults": { "unit": "Bps", "custom": { "fillOpacity": 15, "lineWidth": 2 } }, "overrides": [] }
    }
  ],
  "refresh": "5s",
  "schemaVersion": 39,
  "tags": ["spark", "docker", "monitoring"],
  "templating": { "list": [] },
  "time": { "from": "now-15m", "to": "now" },
  "title": "Spark Cluster Monitoring",
  "uid": "spark-cluster-monitoring"
}
